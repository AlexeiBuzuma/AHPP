CC=gcc
CFLAGS=-Wall -O3 -msse4 -ftree-vectorizer-verbose=5 -funsafe-math-optimizations
OPENMP_CFLAGS=$(CFLAGS) -fopenmp
SOURCES=main.c func.c
HEADERS=func.h
EXEC=main
EXEC_INTRINSIC=$(EXEC)_intr
EXEC_OPENMP=$(EXEC)_openmp
EXEC_INTRINSIC_OPENMP=$(EXEC_INTRINSIC)_openmp
EXECUTABLES=$(EXEC) $(EXEC_INTRINSIC) $(EXEC_OPENMP) $(EXEC_INTRINSIC_OPENMP)

all: $(SOURCES) $(HEADERS) $(EXECUTABLES)

$(EXEC): $(SOURCES) $(HEADERS)
	$(CC) $(SOURCES) $(CFLAGS) -DAHPP_NO_INTRINSIC -o $@

$(EXEC_INTRINSIC): $(SOURCES) $(HEADERS)
	$(CC) $(SOURCES) -DAHPP_INTRINSIC $(CFLAGS) -o $@

$(EXEC_OPENMP): $(SOURCES) $(HEADERS)
	$(CC) $(SOURCES) $(OPENMP_CFLAGS) -DAHPP_NO_INTRINSIC -o $@

$(EXEC_INTRINSIC_OPENMP): $(SOURCES) $(HEADERS)
	$(CC) $(SOURCES) $(OPENMP_CFLAGS) -DAHPP_INTRINSIC -o $@

clean: $(SOURCES) $(HEADERS)
	rm $(EXECUTABLES)

remake: $(SOURCES) $(HEADERS)
	make clean
	make all
